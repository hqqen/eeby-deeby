% clear all;close all;clc;
% % 
% syms m MH MT real;
% syms q1 q2 q3 q4 q5 q1d q2d q3d q4d q5d q1dd q2dd q3dd q4dd q5dd;
% syms q6 q7 q8 q9 q10 q6d q7d q8d q9d q10d q6dd q7dd q8dd q9dd q10dd;
% syms q11 q12 q13 q14 q15 q11d q12d q13d q14d q15d q11dd q12dd q13dd q14dd q15dd;
% syms q16 q17 q18 q19 q20 q16d q17d q18d q19d q20d q16dd q17dd q18dd q19dd q20dd;
% syms L1 L2 L3 L4 L5 mu g
% syms r l real;
% syms u1 u2 u3 real;
% syms g real;
% syms th1 th2 th3 th4 th5 th1d th2d th3d th4d th5d th1dd th2dd th3dd th4dd th5dd;

% q=[q1;q2;q3;q4];%;q5;q6;q7;q8];%;q9;q10;q11;q12];
% dq=[q1d;q2d;q3d;q4d];%;q5d;q6d;q7d;q8d];%;q9d;q10d;q11d;q12d];
% ddq=[q1dd q2dd q3dd q4dd];% q5dd q6dd q7dd q8dd].';% q9dd q10dd q11dd q12dd].';
% L=[L1].';
% m_theta=[];

%%
clear all
% clc

syms a0 a1 a2 a3 a4 a5 a6 a7 a8 a9 a10 a11 a12 a13 a14 a15 a16 a17 a18 a19 a20
syms da0 da1 da2 da3 da4 da5 da6 da7 da8 da9 da10 da11 da12 da13 da14 da15 da16 da17 da18 da19 da20
syms s u v d D L phi m g beta k tau1

a_vect = [a0;a1;a2;a3;a4;a5;a6;a7;a8;a9;a10;a11;a12;a13;a14;a15;a16;a17;a18;a19;a20];
da_vect = [da0;da1;da2;da3;da4;da5;da6;da7;da8;da9;da10;da11;da12;da13;da14;da15;da16;da17;da18;da19;da20];
v_vect = [1;v;v^2;v^3;v^4;v^5;v^6;v^7;v^8;v^9;v^10;v^11;v^12;v^13;v^14;v^15;v^16;v^17;v^18;v^19;v^20];

% phi = 0;
% D = 0.1;
% L = 1;
% m = 1;
% g =9.81;
% syms k
% beta = 0.1;
% syms tau1



i = 1; %% order

aa = a_vect(1:i);
vv = v_vect(1:i);
daa = da_vect(1:i);

q = aa.'*vv;

alpha_ = int(q,v,0,v);

xx = sin(alpha_);

x_ = -L*int(xx,v,0,v);

yy = cos(alpha_);

y_ = L*int(yy,v,0,v);

x = x_ + d*D*cos(alpha_);
y = y_ + d*D*sin(alpha_);


jsd = (jacobian([x;y],aa));

rho = m;

B1 = rho*(jsd.')*jsd;

B_mtx1 = int(B1,d,-0.5,0.5);

D_mtx = int(B_mtx1,v,0,1);

D_mtx1= simplify(expand(D_mtx))  %inertia matrix method 1

% 
% %%Kinetic Energy%%
vx = diff(x,a0)*da0+ diff(x,a1)*da1;
vy = diff(y,a0)*da0+ diff(y,a1)*da1;
KE1 = int(0.5*rho*(vx^2 + vy^2),d,-0.5,0.5);
KE = int(KE1,v,0,1);
%%Potential Energy%%

PE = int(int((rho*g*(sin(phi)*x + cos(phi)*y)),d,-0.5,0.5),v,0,1);


Total_Energy = KE + PE + int(0.5*k*q*q,v,0,1);
%%Solving Lagrangean%%

D_mtx2=(jacobian(KE,daa).');
D_mtx2=(jacobian(D_mtx2,daa));
D_mtx2 = simplify(expand(D_mtx2)) %inertia matrix maethod 2

syms C_mtx real
n=max(size(aa));
for k=1:n
	for j=1:n
		C_mtx(k,j)=0*g;
		for i=1:n
			C_mtx(k,j)=C_mtx(k,j)+1/2*(diff(D_mtx(k,j),aa(i)) + ...
				diff(D_mtx(k,i),aa(j)) - ...
				diff(D_mtx(i,j),aa(k)))*daa(i);
		end
	end
end
C_mtx=simplify(C_mtx)



% g_field = rho*g*sin(phi)*x + rho*g*cos(phi)*y;
% 
% G1 = int(g_field,d,-0.5,0.5);
% 
% G = int(G1,v,0,1);
% 
% G_vect = jacobian(G,aa).'

G_vect = jacobian(PE,aa).';

H = [1 0.5; 0.5 1/3];

Tau=tau1;

%%

phi = 0;
D = 0.1;
L = 1;
m = 2;
g =9.81;
beta = 0.1;
k=1;

a0=0.0000001;
a1=0.0000001;
% theta = 0;
% v=1;
% d=1;
% 
% D= [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (D^2*a1^3*m + 24*L^2*a1*m - 24*L^2*a1*m*cos(a0 + a1/2) + 12*L^2*a0^2*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^2*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^2*m*pi*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))^2 + 12*L^2*a0^2*m*pi*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))^2 - 24*L^2*a0^2*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a0^2*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a0*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 24*L^2*a0*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 24*L^2*a0*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2))/(24*a1^3),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        -(12*L^2*a1^2*m*cos(a0 + a1/2) - 12*L^2*a1^2*m - D^2*a1^4*m + 24*L^2*a0*a1*m - 24*L^2*a0*a1*m*cos(a0 + a1/2) + 12*L^2*a0^3*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^3*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^3*m*pi*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))^2 + 12*L^2*a0^3*m*pi*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))^2 - (12*L^2*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (12*L^2*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (12*L^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (12*L^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - 24*L^2*a0^3*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a0^3*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)) - (12*L^2*a0*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (12*L^2*a0*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (12*L^2*a0*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (12*L^2*a0*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2))/(48*a1^4);
%     -(12*L^2*a1^2*m*cos(a0 + a1/2) - 12*L^2*a1^2*m - D^2*a1^4*m + 24*L^2*a0*a1*m - 24*L^2*a0*a1*m*cos(a0 + a1/2) + 12*L^2*a0^3*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^3*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^3*m*pi*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))^2 + 12*L^2*a0^3*m*pi*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))^2 - (12*L^2*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (12*L^2*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (12*L^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (12*L^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (12*L^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - 24*L^2*a0^3*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a0^3*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)) - (12*L^2*a0*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (12*L^2*a0*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (12*L^2*a0*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (12*L^2*a0*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^2*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0^2*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2))/(48*a1^4), (D^2*a1^5*m + 12*L^2*a1^3*m - 24*L^2*a0*a1^2*m + 24*L^2*a0^2*a1*m + 12*L^2*a1^2*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^4*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a1^2*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 12*L^2*a0^4*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2 + 24*L^2*a0*a1^2*m*cos(a0 + a1/2) - 24*L^2*a0^2*a1*m*cos(a0 + a1/2) + 12*L^2*a1^2*m*pi*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))^2 + 12*L^2*a0^4*m*pi*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))^2 + 12*L^2*a1^2*m*pi*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))^2 + 12*L^2*a0^4*m*pi*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))^2 + (24*L^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(5/2) + (24*L^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(5/2) - (24*L^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(5/2) - (24*L^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(5/2) - 24*L^2*a1^2*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a0^4*m*pi*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a1^2*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)) - 24*L^2*a0^4*m*pi*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)) + (24*L^2*a0^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (24*L^2*a0^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (24*L^2*a0*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (24*L^2*a0*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (24*L^2*a0*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (24*L^2*a0*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (24*L^2*a0^2*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + (24*L^2*a0^2*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (24*L^2*a0*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (24*L^2*a0*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (24*L^2*a0*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (24*L^2*a0*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - 24*L^2*a0^3*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 24*L^2*a0^3*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0^3*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^3*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^3*a1*m*pi^(1/2)*cos(a0^2/(2*a1))*fresnelS((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 24*L^2*a0^3*a1*m*pi^(1/2)*sin(a0^2/(2*a1))*fresnelC((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 24*L^2*a0^3*a1*m*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelS((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 24*L^2*a0^3*a1*m*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelC((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2))/(96*a1^5)]

%%
% D_mtx = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (sin(a0 + a1/2)/a1 - (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1)^2/2 + (cos(a0 + a1/2)/a1 - 1/a1 + (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1)^2/2 + 1/2400, ((cos(a0 + a1/2)/a1 - 1/a1 + (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1)*(a0/(2*a1^2) + pi^(1/2)*cos(a0 + a1/2)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2)))/2 + ((sin(a0 + a1/2)/a1 - (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1)*(pi^(1/2)*sin(a0 + a1/2)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2)))/2 + 1/4800;
%          ((cos(a0 + a1/2)/a1 - 1/a1 + (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1)*(a0/(2*a1^2) + pi^(1/2)*cos(a0 + a1/2)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2)))/2 + ((sin(a0 + a1/2)/a1 - (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 - (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1 + (a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/a1)*(pi^(1/2)*sin(a0 + a1/2)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2)))/2 + 1/4800,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    (a0/(2*a1^2) + pi^(1/2)*cos(a0 + a1/2)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2))^2/2 + (pi^(1/2)*sin(a0 + a1/2)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(2*a1^2*(1/a1)^(1/2)) + (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) + (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2) - (a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(2*a1^2))^2/2 + 1/9600];
% 
% 
%  C_mtx = [ da0*(((cos(a0 + a1/2) + a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 1)*(a0*sin(a0 + a1/2) - a1*sin(a0 + a1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) + a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2)))/(2*a1^3) + ((sin(a0 + a1/2) - a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))*(a0 - a0*cos(a0 + a1/2) + a1*cos(a0 + a1/2) + a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2)))/(2*a1^3)) - da1*(((sin(a0 + a1/2) - a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))*(2*a1*sin(a0 + a1/2) - a1^2*cos(a0 + a1/2) - a0^2*cos(a0 + a1/2) + a0^2 + a0*a1*cos(a0 + a1/2) + a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2)))/(4*a1^4) + ((cos(a0 + a1/2) + a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 1)*(a0^2*sin(a0 + a1/2) - 2*a1 + a1^2*sin(a0 + a1/2) + 2*a1*cos(a0 + a1/2) - a0*a1*sin(a0 + a1/2) + a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + (3*a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - (3*a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2)))/(4*a1^4)),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       (2*da0*sin(a0 + a1/2) - (3*da1)/a1 - (8*da0)/a1 + da1*sin(a0 + a1/2) + (8*da0*cos(a0 + a1/2))/a1 + (3*da1*cos(a0 + a1/2))/a1 + (10*a0*da1)/a1^2 + (a0^2*da1*sin(a0 + a1/2))/a1^2 - (10*a0*da1*cos(a0 + a1/2))/a1^2 - (2*a0*da0*sin(a0 + a1/2))/a1 - (a0*da1*sin(a0 + a1/2))/a1 + 3*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) + 3*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - 3*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - 3*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - (6*a0^2*da0*pi*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2)/a1^2 + (6*a0^3*da1*pi*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2)/a1^3 - (6*a0^2*da0*pi*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2)/a1^2 + (6*a0^3*da1*pi*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2)/a1^3 - 3*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - 3*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + 3*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + 3*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - (6*a0^2*da0*pi*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))^2)/a1^2 + (6*a0^3*da1*pi*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))^2)/a1^3 - (6*a0^2*da0*pi*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))^2)/a1^2 + (6*a0^3*da1*pi*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))^2)/a1^3 + (12*a0^2*da0*pi*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/a1^2 - (12*a0^3*da1*pi*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/a1^3 + (12*a0^2*da0*pi*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/a1^2 - (12*a0^3*da1*pi*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/a1^3 - 11*a0^2*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(5/2) + 11*a0^2*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(5/2) - 10*a0*da0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + 10*a0*da0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - 2*a0^2*da0*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - a0^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + a0^3*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(5/2) - 11*a0^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(5/2) + 11*a0^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(5/2) - 2*a0^2*da0*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - a0^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + a0^3*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(5/2) - 2*a0*da0*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 10*a0*da0*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - 3*a0*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) + 10*a0*da0*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) + 3*a0*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - 2*a0*da0*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 11*a0^2*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(5/2) - 11*a0^2*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(5/2) + 10*a0*da0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - 10*a0*da0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) + 2*a0^2*da0*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) + a0^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - a0^3*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(5/2) + 11*a0^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(5/2) - 11*a0^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(5/2) + 2*a0^2*da0*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) + a0^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(3/2) - a0^3*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(5/2) + 2*a0*da0*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 10*a0*da0*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + 3*a0*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - 10*a0*da0*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) - 3*a0*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(3/2) + 2*a0*da0*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(8*a1^2);
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                ((2*da1*cos(a0 + a1/2))/(1/a1)^(3/2) - (2*da1)/(1/a1)^(3/2) - (a0*da1*sin(a0 + a1/2))/(1/a1)^(3/2) + 4*a0*a1*da1*(1/a1)^(1/2) + 2*a1*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) + 2*a1*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) - 4*a0^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) + a1^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) + 4*a0^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) - a1^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) + 2*a0^3*da1*pi*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))^2*(1/a1)^(1/2) + 2*a0^3*da1*pi*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))^2*(1/a1)^(1/2) + 2*a1*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 2*a1*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 4*a0^2*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) - 4*a0^2*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) - 4*a0*a1*da1*cos(a0 + a1/2)*(1/a1)^(1/2) - 2*a1*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) - 2*a1*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 4*a0^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) - a1^2*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) - 4*a0^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + a1^2*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 2*a0^3*da1*pi*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2*(1/a1)^(1/2) + 2*a0^3*da1*pi*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))^2*(1/a1)^(1/2) - 2*a1*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) - 2*a1*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) - 4*a0^2*da1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 4*a0^2*da1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + a0^2*a1*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + a0^2*a1*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 2*a0*a1*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) - 2*a0*a1*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) - 4*a0^3*da1*pi*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 4*a0^3*da1*pi*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*a1*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)) - a0^2*a1*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)) - 2*a0*a1*da1*pi^(1/2)*cos((a0 + a1)^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))) + 2*a0*a1*da1*pi^(1/2)*sin((a0 + a1)^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(8*a1^5*(1/a1)^(1/2)), - da1*(((a0*sin(a0 + a1/2) - a1*sin(a0 + a1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) + a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))*(a1^3*cos(a0 + a1/2) - a0^3*cos(a0 + a1/2) - 3*a1^2*sin(a0 + a1/2) + a0^3 + 5*a0*a1*sin(a0 + a1/2) - a0*a1^2*cos(a0 + a1/2) + a0^2*a1*cos(a0 + a1/2) - (3*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (3*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (3*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (3*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) + a0^4*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^4*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^4*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^4*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 6*a0^2*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 6*a0^2*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 6*a0^2*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 6*a0^2*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2)))/(16*a1^6) + ((a0 - a0*cos(a0 + a1/2) + a1*cos(a0 + a1/2) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) + a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))*(3*a1^2*cos(a0 + a1/2) - a0^3*sin(a0 + a1/2) + a1^3*sin(a0 + a1/2) + 5*a0*a1 - 5*a0*a1*cos(a0 + a1/2) - a0*a1^2*sin(a0 + a1/2) + a0^2*a1*sin(a0 + a1/2) + (3*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) + (3*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(1/a1)^(3/2) - (3*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - (3*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(3/2) - a0^4*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^4*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0^4*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^4*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 6*a0^2*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 6*a0^2*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 6*a0^2*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 6*a0^2*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2)))/(16*a1^6)) - da0*(((a0 - a0*cos(a0 + a1/2) + a1*cos(a0 + a1/2) - (pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) + a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))*(a0^2*sin(a0 + a1/2) - 2*a1 + a1^2*sin(a0 + a1/2) + 2*a1*cos(a0 + a1/2) - a0*a1*sin(a0 + a1/2) + a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2)))/(8*a1^5) - ((a0*sin(a0 + a1/2) - a1*sin(a0 + a1/2) + (pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) - (pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2))))/(1/a1)^(1/2) + a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))*(2*a1*sin(a0 + a1/2) - a1^2*cos(a0 + a1/2) - a0^2*cos(a0 + a1/2) + a0^2 + a0*a1*cos(a0 + a1/2) + a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - a0^3*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + a0^3*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) + 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2) - 3*a0*a1*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0 + a1)/(a1*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2)))/(8*a1^5))];
% 
% 
% G_vect = [                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            (981*cos(a0^2/(2*a1))*cos((2*(a0/2 + a1/2)^2)/a1))/(200*a1) - (981*sin(a0^2/(2*a1))^2)/(200*a1) - (981*cos(a0^2/(2*a1))^2)/(200*a1) + (981*sin(a0^2/(2*a1))*sin((2*(a0/2 + a1/2)^2)/a1))/(200*a1) + (981*a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(200*a1) - (981*a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(200*a1) - (981*a0*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(200*a1) + (981*a0*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(200*a1);
%         (981*a0*cos(a0^2/(2*a1))^2)/(400*a1^2) + (981*a0*sin(a0^2/(2*a1))^2)/(400*a1^2) + (981*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2)))/(400*a1^2*(1/a1)^(1/2)) + (981*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2)))/(400*a1^2*(1/a1)^(1/2)) + (981*pi^(1/2)*cos(a0^2/(2*a1))*cos((2*(a0/2 + a1/2)^2)/a1)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2))/200 - (981*pi^(1/2)*cos(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(400*a1^2*(1/a1)^(1/2)) + (981*pi^(1/2)*sin(a0^2/(2*a1))*sin((2*(a0/2 + a1/2)^2)/a1)*((1/a1)^(1/2)/pi^(1/2) - (a0/2 + a1/2)/(a1^2*pi^(1/2)*(1/a1)^(1/2)))*(1/a1)^(1/2))/200 - (981*pi^(1/2)*sin(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2)))/(400*a1^2*(1/a1)^(1/2)) - (981*a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(400*a1^2) + (981*a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((2*(1/a1)^(1/2)*(a0/2 + a1/2))/pi^(1/2))*(1/a1)^(1/2))/(400*a1^2) + (981*a0^2*pi^(1/2)*cos(a0^2/(2*a1))*fresnels((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(400*a1^2) - (981*a0^2*pi^(1/2)*sin(a0^2/(2*a1))*fresnelc((a0*(1/a1)^(1/2))/pi^(1/2))*(1/a1)^(1/2))/(400*a1^2)];




thetadoubledot = inv(D_mtx)*(H*[1;0]*Tau - C_mtx*daa - G_vect - k*H*aa -beta*H*daa);



%%
syms q0 q1 dq0 dq1

% a0 = 2*(2*q0 - 3*q1);
% a1 = -6*(q0 - 2*q1);
% 
% da0 = 2*(2*dq0 - 3*dq1);
% da1 = -6*(dq0 - 2*dq1);

H_inv = inv(H);

qq = [q0;q1];
dqq = [dq0;dq1];

D1 = subs(D_mtx,aa,H_inv*qq);
C = subs(C_mtx,[aa;daa],[H_inv*qq;H_inv*dqq]);
G = subs(G_vect,aa,H_inv*qq);

test = diff(D1,q0)

% D1 = simplify(D1)
% C = simplify(C)
% G = simplify(G)

% D1 =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              (L^2*m*(cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2/(6*q0 - 12*q1) + sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2/(6*q0 - 12*q1) - (cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(6*q0 - 12*q1) - (sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(6*q0 - 12*q1) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1))^2)/2 - (D^2*m*(cos(2*q0)/2 - 1/2))/24 + (D^2*m*cos(q0)^2)/24 + (L^2*m*(sin(q0)/(6*q0 - 12*q1) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) - (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*cos((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) - (pi^(1/2)*sin((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1))^2)/2, (D^2*m*cos(q0)^2)/48 - (D^2*m*(cos(2*q0)/2 - 1/2))/48 - (L^2*m*(sin(q0)/(6*q0 - 12*q1) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) - (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*cos((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) - (pi^(1/2)*sin((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1))*((pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (sin(q0)*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) - (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2)))/2 + (L^2*m*(cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2/(6*q0 - 12*q1) + sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2/(6*q0 - 12*q1) - (cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(6*q0 - 12*q1) - (sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(6*q0 - 12*q1) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1))*((cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2*(4*q0 - 6*q1))/(72*(q0 - 2*q1)^2) + (sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2*(4*q0 - 6*q1))/(72*(q0 - 2*q1)^2) - (cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) - (sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2)))/2;
%      (D^2*m*cos(q0)^2)/48 - (D^2*m*(cos(2*q0)/2 - 1/2))/48 - (L^2*m*(sin(q0)/(6*q0 - 12*q1) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) - (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*cos((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) - (pi^(1/2)*sin((2*q0 - 3*q1)^2/(3*q0 - 6*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1))*((pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (sin(q0)*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) - (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2)))/2 + (L^2*m*(cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2/(6*q0 - 12*q1) + sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2/(6*q0 - 12*q1) - (cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(6*q0 - 12*q1) - (sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(6*q0 - 12*q1) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(6*q0 - 12*q1))*((cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2*(4*q0 - 6*q1))/(72*(q0 - 2*q1)^2) + (sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2*(4*q0 - 6*q1))/(72*(q0 - 2*q1)^2) - (cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) - (sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2)))/2,                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  (L^2*m*((cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2*(4*q0 - 6*q1))/(72*(q0 - 2*q1)^2) + (sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))^2*(4*q0 - 6*q1))/(72*(q0 - 2*q1)^2) - (cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) - (sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2))^2)/2 - (D^2*m*(cos(2*q0)/2 - 1/2))/96 + (D^2*m*cos(q0)^2)/96 + (L^2*m*((pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (sin(q0)*(5*q0 - 9*q1))/(36*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1)))/(72*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (pi^(1/2)*fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2))*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) - (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(18*(q0 - 2*q1)^2))^2)/2];
% C =[ ((L^2*m*(sin(q0) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))*(6*q1 - 4*q0 + cos(q0)*(4*q0 - 6*q1) + cos(q0)*(6*q0 - 12*q1) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2)))/(432*(q0 - 2*q1)^3) - (L^2*m*(cos(q0) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 1)*(sin(q0)*(4*q0 - 6*q1) + sin(q0)*(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2)))/(432*(q0 - 2*q1)^3))*(4*dq0 - 6*dq1) - ((L^2*m*(sin(q0) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))*(36*cos(q0)*(q0 - 2*q1)^2 + sin(q0)*(12*q0 - 24*q1) - 4*(2*q0 - 3*q1)^2 + 4*cos(q0)*(2*q0 - 3*q1)^2 + cos(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) - 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(5184*(q0 - 2*q1)^4) - (L^2*m*(cos(q0) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 1)*(12*q0 - 24*q1 + 36*sin(q0)*(q0 - 2*q1)^2 + 4*sin(q0)*(2*q0 - 3*q1)^2 - 12*cos(q0)*(q0 - 2*q1) + sin(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) + 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(5184*(q0 - 2*q1)^4))*(6*dq0 - 12*dq1),                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      -(- 2*L^2*m*sin(q0)*(4*dq0 - 6*dq1) + L^2*m*sin(q0)*(6*dq0 - 12*dq1) - (8*L^2*m*(4*dq0 - 6*dq1))/(6*q0 - 12*q1) + (3*L^2*m*(dq0 - 2*dq1))/(q0 - 2*q1) + (5*L^2*m*(4*q0 - 6*q1)*(6*dq0 - 12*dq1))/(18*(q0 - 2*q1)^2) + (8*L^2*m*cos(q0)*(4*dq0 - 6*dq1))/(6*q0 - 12*q1) - (3*L^2*m*cos(q0)*(6*dq0 - 12*dq1))/(6*q0 - 12*q1) - (5*L^2*m*cos(q0)*(4*q0 - 6*q1)*(6*dq0 - 12*dq1))/(18*(q0 - 2*q1)^2) - (2*L^2*m*sin(q0)*(4*q0 - 6*q1)*(4*dq0 - 6*dq1))/(6*q0 - 12*q1) + (L^2*m*sin(q0)*(4*q0 - 6*q1)*(6*dq0 - 12*dq1))/(6*q0 - 12*q1) + (L^2*m*sin(q0)*(2*q0 - 3*q1)^2*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^2) + (2*L^2*m*pi*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))^2*(2*q0 - 3*q1)^2*(4*dq0 - 6*dq1))/(3*(q0 - 2*q1)^2) - (2*L^2*m*pi*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))^2*(2*q0 - 3*q1)^3*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^3) + (2*L^2*m*pi*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))^2*(2*q0 - 3*q1)^2*(4*dq0 - 6*dq1))/(3*(q0 - 2*q1)^2) - (2*L^2*m*pi*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))^2*(2*q0 - 3*q1)^3*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^3) + (2*L^2*m*pi*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))^2*(2*q0 - 3*q1)^2*(4*dq0 - 6*dq1))/(3*(q0 - 2*q1)^2) - (2*L^2*m*pi*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))^2*(2*q0 - 3*q1)^3*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^3) + (2*L^2*m*pi*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))^2*(2*q0 - 3*q1)^2*(4*dq0 - 6*dq1))/(3*(q0 - 2*q1)^2) - (2*L^2*m*pi*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))^2*(2*q0 - 3*q1)^3*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^3) + 3*L^2*m*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 3*L^2*m*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 3*L^2*m*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 3*L^2*m*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 3*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 3*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 3*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 3*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - (4*L^2*m*pi*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(4*dq0 - 6*dq1))/(3*(q0 - 2*q1)^2) + (4*L^2*m*pi*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^3) - (4*L^2*m*pi*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(4*dq0 - 6*dq1))/(3*(q0 - 2*q1)^2) + (4*L^2*m*pi*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(6*dq0 - 12*dq1))/(9*(q0 - 2*q1)^3) + 10*L^2*m*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) + 8*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) - 4*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 8*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 44*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 10*L^2*m*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) - 8*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) + 4*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 8*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) + 44*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) + 10*L^2*m*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) - 44*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 8*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) + 4*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 8*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 10*L^2*m*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) + 44*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) + 8*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) - 4*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 8*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) + 44*L^2*m*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 44*L^2*m*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) + 44*L^2*m*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 44*L^2*m*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(5/2)*(6*dq0 - 12*dq1) - 2*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(4*dq0 - 6*dq1) + L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(6*dq0 - 12*dq1) - 10*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) + 3*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 2*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(4*dq0 - 6*dq1) - L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(6*dq0 - 12*dq1) + 10*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) - 3*L^2*m*pi^(1/2)*cos((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 10*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) + 3*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) + 2*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(4*dq0 - 6*dq1) - L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(6*dq0 - 12*dq1) + 10*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(4*dq0 - 6*dq1) - 3*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(3/2)*(6*dq0 - 12*dq1) - 2*L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(4*dq0 - 6*dq1) + L^2*m*pi^(1/2)*sin((2*(q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)*(6*dq0 - 12*dq1))/(288*(q0 - 2*q1)^2);
%                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 -((L^2*m*(sin(q0)*(4*q0 - 6*q1) + sin(q0)*(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))*(36*cos(q0)*(q0 - 2*q1)^2 + sin(q0)*(12*q0 - 24*q1) - 4*(2*q0 - 3*q1)^2 + 4*cos(q0)*(2*q0 - 3*q1)^2 + cos(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) - 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(62208*(q0 - 2*q1)^5) - (L^2*m*(6*q1 - 4*q0 + cos(q0)*(4*q0 - 6*q1) + cos(q0)*(6*q0 - 12*q1) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))*(12*q0 - 24*q1 + 36*sin(q0)*(q0 - 2*q1)^2 + 4*sin(q0)*(2*q0 - 3*q1)^2 - 12*cos(q0)*(q0 - 2*q1) + sin(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) + 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(62208*(q0 - 2*q1)^5))*(6*dq0 - 12*dq1), ((L^2*m*(sin(q0)*(4*q0 - 6*q1) + sin(q0)*(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))*(36*cos(q0)*(q0 - 2*q1)^2 + sin(q0)*(12*q0 - 24*q1) - 4*(2*q0 - 3*q1)^2 + 4*cos(q0)*(2*q0 - 3*q1)^2 + cos(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) - 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(62208*(q0 - 2*q1)^5) - (L^2*m*(6*q1 - 4*q0 + cos(q0)*(4*q0 - 6*q1) + cos(q0)*(6*q0 - 12*q1) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))*(12*q0 - 24*q1 + 36*sin(q0)*(q0 - 2*q1)^2 + 4*sin(q0)*(2*q0 - 3*q1)^2 - 12*cos(q0)*(q0 - 2*q1) + sin(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) + 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) - 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 8*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^3*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(4*q0 - 6*q1)*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(62208*(q0 - 2*q1)^5))*(4*dq0 - 6*dq1) - ((L^2*m*(sin(q0)*(4*q0 - 6*q1) + sin(q0)*(6*q0 - 12*q1) + (pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + (pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))*(216*cos(q0)*(q0 - 2*q1)^3 + 108*sin(q0)*(q0 - 2*q1)^2 - 8*(2*q0 - 3*q1)^3 + 8*cos(q0)*(2*q0 - 3*q1)^3 + 36*cos(q0)*(4*q0 - 6*q1)*(q0 - 2*q1)^2 + 5*sin(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) + 4*cos(q0)*(2*q0 - 3*q1)^2*(6*q0 - 12*q1) + (3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(-1/(6*q0 - 12*q1))^(3/2) - (3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(3/2) + (3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(-1/(6*q0 - 12*q1))^(3/2) - (3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(3/2) - 16*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) + 16*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) - 16*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) + 16*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) + 24*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 24*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 24*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 24*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(746496*(q0 - 2*q1)^6) - (L^2*m*(6*q1 - 4*q0 + cos(q0)*(4*q0 - 6*q1) + cos(q0)*(6*q0 - 12*q1) + pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) - 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2) + 4*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))*(216*sin(q0)*(q0 - 2*q1)^3 - 108*cos(q0)*(q0 - 2*q1)^2 + 5*(4*q0 - 6*q1)*(6*q0 - 12*q1) + 8*sin(q0)*(2*q0 - 3*q1)^3 - 5*cos(q0)*(4*q0 - 6*q1)*(6*q0 - 12*q1) + 36*sin(q0)*(4*q0 - 6*q1)*(q0 - 2*q1)^2 + 4*sin(q0)*(2*q0 - 3*q1)^2*(6*q0 - 12*q1) - (3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(-1/(6*q0 - 12*q1))^(3/2) + (3*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(3/2) + (3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2)))/(-1/(6*q0 - 12*q1))^(3/2) - (3*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))))/(-1/(6*q0 - 12*q1))^(3/2) + 16*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) - 16*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) - 16*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) + 16*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^4*(-1/(6*q0 - 12*q1))^(1/2) + 24*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 24*pi^(1/2)*cos((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) + 24*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2) - 24*pi^(1/2)*sin((2*(2*q0 - 3*q1)^2)/(6*q0 - 12*q1))*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*(2*q0 - 3*q1)^2*(6*q0 - 12*q1)*(-1/(6*q0 - 12*q1))^(1/2)))/(746496*(q0 - 2*q1)^6))*(6*dq0 - 12*dq1)];
% G =[                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   (L*g*m*cos(phi))/(12*q0 - 24*q1) - (L*g*m*cos(phi + q0))/(12*q0 - 24*q1) + (L*g*m*pi^(1/2)*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*cos((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(2*(6*q0 - 12*q1)) - (L*g*m*pi^(1/2)*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*cos((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(2*(6*q0 - 12*q1)) + (L*g*m*pi^(1/2)*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*sin((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(2*(6*q0 - 12*q1)) - (L*g*m*pi^(1/2)*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*sin((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/(2*(6*q0 - 12*q1));
%     (L*g*m*cos(phi)*(2*q0 - 3*q1))/(72*(q0 - 2*q1)^2) - (L*g*m*cos(phi + q0)*(5*q0 - 9*q1))/(72*(q0 - 2*q1)^2) + (L*g*m*pi^(1/2)*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*cos((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1)))/(144*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (L*g*m*pi^(1/2)*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*cos((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1)))/(144*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) - (L*g*m*pi^(1/2)*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*sin((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1)))/(144*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (L*g*m*pi^(1/2)*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*sin((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1)))/(144*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 2*q1)^2) + (L*g*m*pi^(1/2)*fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*cos((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(36*(q0 - 2*q1)^2) - (L*g*m*pi^(1/2)*fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*cos((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(36*(q0 - 2*q1)^2) + (L*g*m*pi^(1/2)*fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2))*sin((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(36*(q0 - 2*q1)^2) - (L*g*m*pi^(1/2)*fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)))*sin((4*q0^2 - 12*q0*q1 + 3*phi*q0 + 9*q1^2 - 6*phi*q1)/(3*q0 - 6*q1))*(2*q0 - 3*q1)^2*(-1/(6*q0 - 12*q1))^(1/2))/(36*(q0 - 2*q1)^2)];


B_tilde = H_inv*D1*H_inv;
C_tilde = H_inv*C*H_inv;
G_tilde = H_inv*G;
K_tilde = k*H_inv;
D_tilde = beta*H_inv;

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%Romeo
maa = B_tilde(1,1);
mau = B_tilde(1,2);
muu = B_tilde(2,2);

mau_dot  = diff(mau,q0)*dq0 + diff(mau,q1)*dq1

VN_dot = -mau*dq1;
VN = -int(mau,q1)

grad_V = G_tilde + K_tilde*qq;

V = int()

gVa = grad_V(1);
gVu = grad_V(2);

CC = C_tilde*dqq + D_tilde*dqq;
cu = CC(2)

K_qu = ke + ka*Kk + ku*Kk*mau*(1/muu)*mau.';

Md_11 = ke*ka + ka*ka*Kk;
Md_12 = -ka*ku*Kk*mau;
Md_21 = -ka*ku*Kk*mau;
Md_22 = ke*ku*muu + ku*ku*mau*Kk*mau;

VN = 0;
Vu = V(2);
Va = V(1)

V_d = ke*ku*Vu + 0.5*(ka*q0 + ku*VN).^2*KI;

S = ku*Kk*(-mau_dot*dq1 + mau*muu*(cu*dq1 + gVu)) + KI*(ka*q0+ku*VN);

ya = dq0;
yu = -mau*qd1;

u = -(1/K_qu)*(S + Kp*(ka*ya + ku*yu));
%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%







hqq  = C_tilde*dqq + G_tilde + K_tilde*qq + D_tilde*dqq;

ddqq = inv(B_tilde)*(Tau - hqq);

u = -wP*q0 - wD*dq0;

new_tau = (hqq(1) - (B_tilde(2,1)/B_tilde(2,2))/hqq(2)) + (B_tilde(1,1) - B_tilde(2,1)*B_tilde(2,1)/B_tilde(2,2))*u;


% 
% frC1 = fresnelc((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2));
% frS1 = fresnels((2*(-1/(6*q0 - 12*q1))^(1/2)*(q0 - 3*q1))/pi^(1/2));
% frC2 = fresnelc(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2));
% frS2 = fresnels(((4*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2))/pi^(1/2));
% frC3 = fresnelc((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)));
% frS3 = fresnels((q0 - 3*q1)/(pi^(1/2)*(3*q0 - 6*q1)*(-1/(6*q0 - 12*q1))^(1/2)));
% syms k d tau1 tau2 tau3 Fx Fy
% 
% Damp=d*eye(2);
% K=k*eye(2);
% Tau=[tau1;tau2];
% Fext=[Fx;Fy];
% 
% % pxx=2*L1./th1.*sin(th1/2).*sin(th1/2);+2*L2./th2.*sin((th2)/2).*sin((2*th1+th2)/2); 
% % pyy=2*L1./th1.*sin(th1/2).*cos(th1/2);+2*L2./th2.*sin((th2)/2).*cos((2*th1+th2)/2);
% 
% pxx=L1*(1-0.0375*th1^2).*sin(th1/2);%+L2*(1-0.0375*th2^2).*sin((2*th1+th2)/2); 
% pyy=L1*(1-0.0375*th1^2).*cos(th1/2);%+L2*(1-0.0375*th2^2).*cos((2*th1+th2)/2);
% 
% Jacob=jacobian([pxx;pyy],theta);
% 
% px=L1*cos(th1);
% py=L1*sin(th1);
% 
% Jacobb=jacobian([px;py],theta);
% 
% % 
% %%complete eqqations
% thetadoubledot=simplify(inv(B)*(Tau-Jacob.'*Fext-((C+Damp)*dtheta+G+K*theta)));
% 
% 
% fx=[dtheta;thetadoubledot];
% XX=[theta;dtheta];
% % gx=B*thetadoubledot+(C+Damp)*dtheta+G+K*theta-Tau;
% gx=simplify([inv(Jacob.')*(-B*ddtheta-(C+Damp)*dtheta-G-K*theta+Tau)]);
% 
% A_matrix=jacobian(fx,XX);
% B_matrix=jacobian(fx,Tau);
% C_matrix=jacobian(gx,XX);
% D_matrix=jacobian(gx,Tau);
% 
% %%
% 
% ref_theta=[1,1];
% ref_dtheta=[0,0];
% ref_ddtheta=[0,0];
% mass=0.025;
% Len=[0.1,0.1];
% k_ref=0.7;
% d_ref=0.25;
% ref_tau=[1,1];
% F_ref=[-1,-1];
% 
% %%%%%%Working set%%%%%%%%%
% ref_theta=[1,1];
% ref_dtheta=[0,0];
% ref_ddtheta=[0,0];
% mass=0.5;
% Len=[1,1];
% k_ref=0.5;
% d_ref=0.5;
% % ref_tau=[1.3022,1.0261];
% F_ref=[1,-1];
% %%%%%%%%%%%%%%%%%%%%%%%%%
% 
% ref_theta=[1.5,2];
% ref_dtheta=[0,0];
% ref_ddtheta=[0,0];
% mass=0.023;
% Len=[0.0275,0.025];
% k_ref=0.1;
% d_ref=0.5;
% % ref_tau=[1.3022,1.0261];
% F_ref=[0.5,-1.7];
% 
% % ref_point=[ref_theta,ref_dtheta,ref_ddtheta,mass,Len,k_ref,d_ref,ref_tau,F_ref];
% 
% JJ=double(subs(Jacob,[th1,th2,L1,L2],[ref_theta,Len]))
% 
% 
% ref_tau=(0.5*ref_theta.'+JJ.'*F_ref.').'
% 
% ref_point=[ref_theta,ref_dtheta,ref_ddtheta,mass,Len,k_ref,d_ref,ref_tau,F_ref];
% 
% AA=double(subs(A_matrix,[th1,th2,th1d,th2d,th1dd,th2dd,mu,L1,L2,k,d,tau1,tau2,Fx,Fy],ref_point));
% BB=double(subs(B_matrix,[th1,th2,th1d,th2d,th1dd,th2dd,mu,L1,L2,k,d,tau1,tau2,Fx,Fy],ref_point));
% CC=double(subs(C_matrix,[th1,th2,th1d,th2d,th1dd,th2dd,mu,L1,L2,k,d,tau1,tau2,Fx,Fy],ref_point));
% DD=double(subs(D_matrix,[th1,th2,th1d,th2d,th1dd,th2dd,mu,L1,L2,k,d,tau1,tau2,Fx,Fy],ref_point));
% 
% eigAA=eig(AA)
% 
% rank(ctrb(AA,BB))
% 
% rank(obsv(AA,CC))
% 
% %%
% 


